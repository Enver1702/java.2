Не уверен что получилось правильно, т.к. даже на вашем коде выдает ошибку(на match) хотя у вас он работает .Я 3 раза проверил на синтаксические ошибки (может что-то пропустил) . Не могу понять как исправить,поэтому не могу проверить свой код.